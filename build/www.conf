<Directory />
  Options FollowSymLinks
  AllowOverride None
  Require all granted
</Directory>

<Directory "/var/www/html">
  Options Indexes FollowSymLinks MultiViews
  AllowOverride all

  #apache 2.4
  Require all granted
</Directory>

<VirtualHost *:80>
  ServerName www
  ServerAlias www-*
  ServerAlias www.*
  ServerAlias localhost

  PassEnv DOCUMENT_ROOT
  DocumentRoot "${DOCUMENT_ROOT}"

  RewriteMap lowercase int:tolower
  DirectoryIndex index.php index.htm index.html index.xhtml

  RewriteEngine on
  RewriteMap lc int:tolower

  ## logging
  errorlog "/dev/stderr"
  serversignature off
  customlog "/dev/stdout" "combinedx" env=!forwarded
  customlog "/dev/stdout" "proxy" env=forwarded

  ## setenv/setenvif for environment variables
  setenvif x-forwarded-for "^.*\..*\..*\..*" forwarded
  setenvif x-forwarded-proto https https=on

  ## pass to php fpm
  PassEnv WWW_FPM_SERVICE_HOST
  PassEnv WWW_FPM_SERVICE_PORT

  <FilesMatch \.php$>
      SetHandler "proxy:fcgi://${WWW_FPM_SERVICE_HOST}:${WWW_FPM_SERVICE_PORT}"
  </FilesMatch>
</VirtualHost>
